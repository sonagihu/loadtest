다음 요구사항에 맞는 복잡한 쿼리를 작성해주세요:

1. 주문 분석을 위한 복잡한 쿼리가 필요합니다.
2. 다음 통계 정보가 필요합니다:
   - 고객별 구매 금액 합계
   - 상품별 판매 수량
   - 기간별 매출 추이
   - 카테고리별 판매 비율
3. 다음 조인 조건이 필요합니다:
   - 주문-주문상품-상품-카테고리
   - 주문-고객-배송지
4. 다음 집계 함수가 필요합니다:
   - SUM
   - COUNT
   - AVG
   - GROUP BY
5. 다음 필터링 조건이 필요합니다:
   - 기간
   - 금액
   - 상태
6. 성능 최적화가 필요합니다. 